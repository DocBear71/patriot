<!-- admin-code-management.html - Only accessible to existing admins -->
<!DOCTYPE html>
<html lang="en">
<head>
    <title>Admin Dashboard - Patriot Thanks</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="author" content="Edward G. McKeown">
    <meta name="date" content="2025/4/12">
    <meta name="description" content="Patriot Thanks application to find businesses that offer
                                          incentives and discounts to veterans, active-duty, first
                                          responders, and their spouses.">
    <meta name="keywords" content="business, incentives, discounts, veteran discounts, military discounts,
                                       first responder discounts, veterans, active-duty, first responders">
    <link href="./images/docbearlogov4.png" rel="icon" type="image/x-icon">
    <link href="./css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link href="./css/normalize.css" rel="stylesheet">
    <link href="./css/style.css" rel="stylesheet">
    <link href="./css/figures.css" rel="stylesheet">
    <link href="./css/menu-auth.css" rel="stylesheet">
    <link href="./css/forms.css" rel="stylesheet">
    <link href="./css/form-validation.css" rel="stylesheet">
    <link href="./css/dashboard.css" rel="stylesheet">
    <link href="./css/admin/admin-users.css" rel="stylesheet">
    <link href="./css/menu-auth.css" rel="stylesheet">
    <link href="./css/layout-fix.css" rel="stylesheet">
    <script src="./js/jquery-3.7.1.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>
    <script src="./js/admin-users.js"></script>
    <script src="./js/layout-manager.js"></script>
</head>
<body style="padding-top: 70px" id="page_layout">
<div id="nav-placeholder"></div>
<header>
    <br>
    <div class="left-banner">
        <a href="./index.html">
            <img src="./images/docbearlogov4.png" alt="DocBear logo">
        </a>
    </div>
    <div class="right-banner">
        <h1>Patriot Thanks</h1>
        <hr>
        <h4>Admin Dashboard - User Management</h4>
    </div>
    <div style="clear:left;"></div>
</header>

<main class="admin-container">
    <div class="admin-header">
        <h2>User Management</h2>
        <a href="admin-dashboard.html" class="btn btn-secondary mr-2">Return to Dashboard</a>
        <button class="btn btn-primary" id="add-user-btn" data-bs-toggle="modal" data-target="#userModal">Add New User</button>
    </div>

    <div class="filter-container">
        <input type="text" class="search-box" id="user-search" placeholder="Search users...">

        <div class="filter-item">
            <label for="status-filter">Status:</label>
            <select id="status-filter">
                <option value="">All</option>
                <option value="VT">Veteran</option>
                <option value="AD">Active-Duty</option>
                <option value="FR">First Responder</option>
                <option value="SP">Spouse</option>
                <option value="BO">Business Owner</option>
                <option value="SU">Supporter</option>
            </select>
        </div>

        <div class="filter-item">
            <label for="level-filter">Level:</label>
            <select id="level-filter">
                <option value="">All</option>
                <option value="Free">Free</option>
                <option value="Basic">Basic</option>
                <option value="Premium">Premium</option>
                <option value="VIP">V.I.P.</option>
                <option value="Admin">Admin</option>
            </select>
        </div>

        <button id="reset-filters" class="btn btn-secondary">Reset Filters</button>
    </div>

    <div class="table-responsive">
        <table class="data-table">
            <thead>
            <tr>
                <th>Name</th>
                <th>Email</th>
                <th>Location</th>
                <th>Status</th>
                <th>Level</th>
                <th>Created</th>
                <th>Actions</th>
            </tr>
            </thead>
            <tbody id="user-table-body">
            <!-- User data will be populated here -->
            </tbody>
        </table>
    </div>

    <ul class="pagination" id="pagination-container">
        <!-- Pagination will be populated here -->
    </ul>

    <!-- User Modal -->
    <div class="modal fade" id="userModal" tabindex="-1" role="dialog" aria-labelledby="userModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="userModalLabel">Add/Edit User</h5>
                    <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="user-form" class="modal-form">
                        <input type="hidden" id="user-id" name="user-id">

                        <div class="form-group">
                            <label for="fname">First Name</label>
                            <input type="text" id="fname" name="fname" required>
                        </div>

                        <div class="form-group">
                            <label for="lname">Last Name</label>
                            <input type="text" id="lname" name="lname" required>
                        </div>

                        <div class="form-group">
                            <label for="email">Email</label>
                            <input type="email" id="email" name="email" required>
                        </div>

                        <div class="form-group">
                            <label for="address1">Address 1</label>
                            <input type="text" id="address1" name="address1">
                        </div>

                        <div class="form-group">
                            <label for="address2">Address 2</label>
                            <input type="text" id="address2" name="address2">
                        </div>

                        <div class="form-group">
                            <label for="city">City</label>
                            <input type="text" id="city" name="city">
                        </div>

                        <div class="form-group">
                            <label for="state">State</label>
                            <select id="state" name="state">
                                <option value="">Select a State</option>
                                <option value="AL">Alabama</option>
                                <option value="AK">Alaska</option>
                                <option value="AZ">Arizona</option>
                                <option value="AR">Arkansas</option>
                                <option value="CA">California</option>
                                <option value="CO">Colorado</option>
                                <option value="CT">Connecticut</option>
                                <option value="DE">Delaware</option>
                                <option value="DC">District Of Columbia</option>
                                <option value="FL">Florida</option>
                                <option value="GA">Georgia</option>
                                <option value="HI">Hawaii</option>
                                <option value="ID">Idaho</option>
                                <option value="IL">Illinois</option>
                                <option value="IN">Indiana</option>
                                <option value="IA">Iowa</option>
                                <option value="KS">Kansas</option>
                                <option value="KY">Kentucky</option>
                                <option value="LA">Louisiana</option>
                                <option value="ME">Maine</option>
                                <option value="MD">Maryland</option>
                                <option value="MA">Massachusetts</option>
                                <option value="MI">Michigan</option>
                                <option value="MN">Minnesota</option>
                                <option value="MS">Mississippi</option>
                                <option value="MO">Missouri</option>
                                <option value="MT">Montana</option>
                                <option value="NE">Nebraska</option>
                                <option value="NV">Nevada</option>
                                <option value="NH">New Hampshire</option>
                                <option value="NJ">New Jersey</option>
                                <option value="NM">New Mexico</option>
                                <option value="NY">New York</option>
                                <option value="NC">North Carolina</option>
                                <option value="ND">North Dakota</option>
                                <option value="OH">Ohio</option>
                                <option value="OK">Oklahoma</option>
                                <option value="OR">Oregon</option>
                                <option value="PA">Pennsylvania</option>
                                <option value="RI">Rhode Island</option>
                                <option value="SC">South Carolina</option>
                                <option value="SD">South Dakota</option>
                                <option value="TN">Tennessee</option>
                                <option value="TX">Texas</option>
                                <option value="UT">Utah</option>
                                <option value="VT">Vermont</option>
                                <option value="VA">Virginia</option>
                                <option value="WA">Washington</option>
                                <option value="WV">West Virginia</option>
                                <option value="WI">Wisconsin</option>
                                <option value="WY">Wyoming</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="zip">Zip Code</label>
                            <input type="text" id="zip" name="zip">
                        </div>

                        <div class="form-group">
                            <label for="status">Status</label>
                            <select id="status" name="status" required>
                                <option value="">Select a Status</option>
                                <option value="VT">Veteran</option>
                                <option value="AD">Active-Duty</option>
                                <option value="FR">First Responder</option>
                                <option value="SP">Spouse</option>
                                <option value="BO">Business Owner</option>
                                <option value="SU">Supporter</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="level">Membership Level</label>
                            <select id="level" name="level" required>
                                <option value="">Select a Membership Level</option>
                                <option value="Free">Free</option>
                                <option value="Basic">Basic</option>
                                <option value="Premium">Premium</option>
                                <option value="VIP">V.I.P.</option>
                                <option value="Admin">Admin</option>
                            </select>
                        </div>

                        <div id="password-section">
                            <div class="form-group">
                                <label for="password">Password</label>
                                <input type="password" id="password" name="password">
                                <small class="form-text text-muted">Leave blank to keep current password (when editing)</small>
                            </div>

                            <div class="form-group">
                                <label for="confirm-password">Confirm Password</label>
                                <input type="password" id="confirm-password" name="confirm-password">
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="save-user-btn">Save User</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div class="modal fade" id="confirmationModal" tabindex="-1" role="dialog" aria-labelledby="confirmationModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="confirmationModalLabel">Confirm Action</h5>
                    <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body" id="confirmation-message">
                    Are you sure you want to delete this user?
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-danger" id="confirm-action-btn">Delete</button>
                </div>
            </div>
        </div>
    </div>
</main>
<footer class="footer_style">
    <br><br>
    <p>&copy; Copyright 2024 Doc Bear Enterprises, LLC</p>
    <div class="footer-links">
        <a href="terms.html">Terms of Use</a> |
        <a href="privacy.html">Privacy Policy</a> |
        <a href="contact.html">Contact Us</a>
    </div>
    <br><br>
</footer>
<button id="emergencyResetBtn" style="position: fixed; bottom: 10px; right: 10px; z-index: 9999; background-color: #dc3545; color: white; border: none; padding: 8px 15px; border-radius: 4px; font-weight: bold; display: none; cursor: pointer; box-shadow: 0 2px 5px rgba(0,0,0,0.2);">
    Emergency Reset
</button>
<script src="./js/bootstrap.bundle.min.js"></script>
<script src="./js/bootstrap5-modal-helper.js"></script>
<script>
    $(function(){
        $("#nav-placeholder").load("NavBar.html", function() {
            console.log("NavBar loaded");

            // Load terms modal script
            $.getScript("./js/terms-modal.js")
            .done(function() {
                console.log("Terms modal script loaded successfully");

                // Load login handler
                $.getScript("./js/bootstrap5-login-handler.js")
                .done(function() {
                    console.log("Login handler script loaded successfully");

                    // Check login status if function exists
                    setTimeout(function() {
                        if (typeof checkLoginStatus === 'function') {
                            checkLoginStatus();
                        }
                    }, 500);
                });
            });
        });
    });
    document.getElementById('emergencyResetBtn').addEventListener('click', function() {
        console.log("Emergency reset button clicked");
        $('.modal-backdrop').remove();
        $('body').removeClass('modal-open');
        $('body').css('padding-right', '');
        $('.modal').hide();
        $('body').css('overflow', '');
        this.style.display = 'none';
    });
    setTimeout(function() {
        const modalVisible = $('.modal').is(':visible') ||
                $('.modal-backdrop').length > 0 ||
                $('body').hasClass('modal-open');

        if (modalVisible) {
            console.log("Modal appears to be stuck - showing emergency reset button");
            document.getElementById('emergencyResetBtn').style.display = 'block';
        }
    }, 10000);
</script>
</body>
</html>