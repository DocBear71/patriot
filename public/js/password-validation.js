document.addEventListener("DOMContentLoaded",(function(){console.log("Password validation script loaded");const s=document.getElementById("submit");s&&(s.disabled=!0);var e=document.getElementById("psw"),a=document.getElementById("psw_repeat"),t=document.getElementById("message"),l=document.getElementById("letter"),i=document.getElementById("capital"),d=document.getElementById("number"),n=document.getElementById("length"),c=document.getElementById("special"),o=document.getElementById("match");function v(){if(o){var t=e.value,l=a.value;""===t||""===l||t!=l?(o.classList.remove("valid"),o.classList.add("invalid"),s&&(s.disabled=!0)):(o.classList.remove("invalid"),o.classList.add("valid"),m()&&s&&(s.disabled=!1))}}function m(){return!!(l&&i&&d&&c&&n&&o)&&l.classList.contains("valid")&&i.classList.contains("valid")&&d.classList.contains("valid")&&c.classList.contains("valid")&&n.classList.contains("valid")&&o.classList.contains("valid")}e&&a&&t?(console.log("Password validation elements found"),o&&(o.style.display="none"),e.onfocus=function(){t.style.display="block",o&&(o.style.display="none")},a.onfocus=function(){t.style.display="block",o&&(o.style.display="block")},e.onblur=function(){document.activeElement!==a&&(t.style.display="none")},a.onblur=function(){document.activeElement!==e&&(t.style.display="none")},e&&a&&(e.addEventListener("keyup",v),a.addEventListener("keyup",v)),window.validatePassword=function(s){var e=/[a-z]/g.test(s),a=/[A-Z]/g.test(s),t=/[0-9]/g.test(s),l=/[!@#$%^&*]/g.test(s),i=s.length>=8;return{isValid:e&&a&&t&&l&&i,criteria:{hasLower:e,hasUpper:a,hasNumber:t,hasSpecial:l,hasLength:i}}},e&&(e.onkeyup=function(){l&&i&&d&&c&&n&&(e.value.match(/[a-z]/g)?(l.classList.remove("invalid"),l.classList.add("valid")):(l.classList.remove("valid"),l.classList.add("invalid")),e.value.match(/[A-Z]/g)?(i.classList.remove("invalid"),i.classList.add("valid")):(i.classList.remove("valid"),i.classList.add("invalid")),e.value.match(/[0-9]/g)?(d.classList.remove("invalid"),d.classList.add("valid")):(d.classList.remove("valid"),d.classList.add("invalid")),e.value.match(/[!@#$%^&*]/g)?(c.classList.remove("invalid"),c.classList.add("valid")):(c.classList.remove("valid"),c.classList.add("invalid")),e.value.length>=8?(n.classList.remove("invalid"),n.classList.add("valid")):(n.classList.remove("valid"),n.classList.add("invalid")),m()?s&&(s.disabled=!1):s&&(s.disabled=!0),v())})):console.log("Not on a page with password validation elements")}));