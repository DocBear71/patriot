document.addEventListener("DOMContentLoaded",(function(){console.log("Enhanced Reset Functionality Loaded!");const e=null!==document.getElementById("incentive-section"),n=null!==document.getElementById("incentive-edit-section"),t=null!==document.getElementById("incentives-container");if(console.log("Page detection - Add:",e,"Update:",n,"View:",t),e){const m=window.addIncentive;if("function"==typeof m)window.addIncentive=function(e){console.log("Enhanced addIncentive called with auto-reset"),m(e).then((function(e){console.log("Incentive added successfully, auto-resetting form..."),l()})).catch((function(e){console.error("Error in incentive submission:",e)}))};else{const y=document.getElementById("incentive-form");if(y){const p=y.cloneNode(!0);y.parentNode.replaceChild(p,y),p.addEventListener("submit",(function(e){e.preventDefault(),document.getElementById("selected-business-id").value,fetch("https://patriotthanks.vercel.app/api/incentives.js",{method:"POST"}).then((e=>e.json())).then((e=>{console.log("Incentive added successfully, auto-resetting form..."),alert("Incentive added successfully!"),l()})).catch((e=>{console.error("Error adding incentive:",e),alert(`Error adding incentive: ${e.message}`)}))}))}}}if(n){function o(){try{const e=localStorage.getItem("patriotThanksSession");return e&&JSON.parse(e).token||null}catch(e){return console.error("Error retrieving auth token:",e),null}}function s(e,n){const t=document.getElementById("status-message");t?(t.innerHTML=n,t.className="alert","error"===e?t.classList.add("alert-danger"):"success"===e&&t.classList.add("alert-success"),t.style.display="block",t.scrollIntoView({behavior:"smooth"}),setTimeout((()=>{t.style.display="none"}),5e3)):alert(n)}"function"==typeof window.updateIncentive&&(window.updateIncentive=function(e){console.log("Enhanced updateIncentive called with auto-reset");const n=`${"localhost"===window.location.hostname?"http://":"https://"}${window.location.host}/api/admin-incentives.js?operation=update`,t=document.getElementById("update-submit"),i=t.value;t.value="Updating...",t.disabled=!0,fetch(n,{method:"PUT",headers:{"Content-Type":"application/json; charset=utf-8",Authorization:`Bearer ${o()||""}`},body:JSON.stringify(e)}).then((e=>e.ok?e.json():e.text().then((n=>{throw new Error(`Failed to update incentive: ${e.status} ${n}`)})))).then((e=>{console.log("Success:",e),s("success","Incentive updated successfully!"),t.value=i,t.disabled=!1,setTimeout((()=>{l()}),2e3)})).catch((e=>{console.error("Error:",e),s("error","Update failed: "+e.message),t.value=i,t.disabled=!1}))})}function i(){const e=document.createElement("button");return e.id="reset-button",e.type="button",e.innerText="Start Over",e.style.backgroundColor="#0000ff",e.style.color="white",e.style.border="none",e.style.padding="10px 20px",e.style.borderRadius="4px",e.style.cursor="pointer",e.style.marginTop="20px",e.style.fontWeight="bold",e.onmouseover=function(){this.style.backgroundColor="#0000cc"},e.onmouseout=function(){this.style.backgroundColor="#0000ff"},e}function c(){const e=document.createElement("div");return e.id="reset-button-container",e.style.textAlign="center",e.style.marginBottom="20px",e}function d(){const e=document.getElementById("business-name");e&&(e.value="");const n=document.getElementById("address");n&&(n.value="");const t=document.getElementById("business-search-results");t&&(t.innerHTML=""),e&&e.focus()}function l(){if(d(),e){const e=document.getElementById("business-info-section");e&&(e.style.display="none");const n=document.getElementById("incentive-section");n&&(n.style.display="none"),function(){a("bname"),a("address1"),a("address2"),a("city"),a("state"),a("zip"),a("phone"),a("type");const e=document.getElementById("incentiveAvailable"),n=document.getElementById("incentiveNotAvailable");e&&(e.checked=!1),n&&(n.checked=!1),a("incentiveType"),a("incentiveAmount"),a("incentiveInfo");const t=document.getElementById("otherTypeContainer");t&&(t.style.display="none"),a("otherTypeDescription");const o=document.getElementById("discountTypePercentage");o&&(o.checked=!0);const s=document.getElementById("discountTypeDollar");s&&(s.checked=!1)}()}else if(n){const e=document.getElementById("business-info-section");e&&(e.style.display="none");const n=document.getElementById("incentives-list-section");n&&(n.style.display="none");const t=document.getElementById("incentive-edit-section");t&&(t.style.display="none");const o=document.getElementById("incentives-table-container");o&&(o.innerHTML=""),function(){const e=document.getElementById("incentiveAvailable"),n=document.getElementById("incentiveNotAvailable");e&&(e.checked=!1),n&&(n.checked=!1),a("incentiveType"),a("incentiveAmount"),a("incentiveInfo"),a("otherTypeDescription");const t=document.getElementById("otherTypeContainer");t&&(t.style.display="none");const o=document.getElementById("discountTypePercentage");o&&(o.checked=!0);const s=document.getElementById("discountTypeDollar");s&&(s.checked=!1),["business-name-display","business-address-display","business-city-state-display","business-phone-display","business-type-display"].forEach((e=>{const n=document.getElementById(e);n&&(n.textContent="")}))}()}else if(t){const e=document.getElementById("business-info-section");e&&(e.style.display="none");const n=document.getElementById("incentives-container");n&&(n.innerHTML="")}const o=document.getElementById("selected-business-id");o&&(o.value="");const s=document.getElementById("selected-incentive-id");s&&(s.value=""),window.scrollTo(0,0),console.log("Page has been reset")}function a(e){const n=document.getElementById(e);n&&("SELECT"===n.tagName?n.selectedIndex=0:"TEXTAREA"!==n.tagName&&"INPUT"!==n.tagName||(n.value=""),n.classList.remove("valid-field"),n.classList.remove("invalid-field"))}!function(){const o=document.querySelector("fieldset:first-of-type");if(o){const e=c(),n=i();n.innerText="Clear Search",n.addEventListener("click",(function(){d()})),e.appendChild(n),o.appendChild(e)}if(e){const e=document.getElementById("incentive-section");if(e){const n=c(),t=i();t.addEventListener("click",(function(){l()})),n.appendChild(t),e.appendChild(n)}}else if(n){const e=document.getElementById("incentive-edit-section");if(e){const n=c(),t=i();t.addEventListener("click",(function(){l()})),n.appendChild(t),e.appendChild(n)}}else if(t){const e=document.querySelector("main");if(e){const n=c(),t=i();t.addEventListener("click",(function(){l()})),n.style.position="sticky",n.style.bottom="20px",n.style.zIndex="1000",n.appendChild(t),e.appendChild(n);const o=document.getElementById("incentives-container");if(o){const e=i();e.addEventListener("click",(function(){l()}));const n=c();n.appendChild(e),o.appendChild(n)}}}}();const u=document.createElement("style");u.textContent="\n        @media (max-width: 768px) {\n            #reset-button {\n                width: 100%;\n                padding: 15px;\n                font-size: 16px;\n                margin-top: 10px;\n            }\n            \n            #reset-button-container {\n                position: sticky;\n                bottom: 10px;\n                z-index: 1000;\n                margin: 10px 0;\n            }\n            \n            #reset-button-container button {\n                box-shadow: 0 2px 5px rgba(0,0,0,0.3);\n            }\n        }\n    ",document.head.appendChild(u),document.addEventListener("keydown",(function(e){e.altKey&&"r"===e.key&&(e.preventDefault(),l())}));const r=window.alert;window.alert=function(e){r(e),e&&"string"==typeof e&&(e.toLowerCase().includes("success")||e.toLowerCase().includes("added")||e.toLowerCase().includes("updated"))&&(console.log("Success message detected, scheduling auto-reset"),setTimeout((()=>{l()}),1500))},console.log("Enhanced reset functionality setup complete")}));