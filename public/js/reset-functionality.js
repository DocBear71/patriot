document.addEventListener("DOMContentLoaded",(function(){console.log("Enhanced Reset Functionality Loaded!");const e=window.location.pathname,t=e.includes("business-update.html")||null!==document.getElementById("business-update-form"),n=!t&&null!==document.getElementById("incentive-section"),o=!t&&null!==document.getElementById("incentive-edit-section"),s=!t&&(e.includes("incentive-view.html")||null!==document.getElementById("incentives-container"));function i(){const e=document.createElement("button");return e.id="reset-button",e.type="button",e.innerText="Start Over",e.style.backgroundColor="#0000ff",e.style.color="white",e.style.border="none",e.style.padding="10px 20px",e.style.borderRadius="4px",e.style.cursor="pointer",e.style.marginTop="20px",e.style.fontWeight="bold",e.onmouseover=function(){this.style.backgroundColor="#0000cc"},e.onmouseout=function(){this.style.backgroundColor="#0000ff"},e}function d(){const e=document.createElement("div");return e.id="reset-button-container",e.style.textAlign="center",e.style.marginBottom="20px",e}function c(){const e=document.getElementById("business-name");e&&(e.value="",e.disabled=!1);const t=document.getElementById("address");t&&(t.value="",t.disabled=!1);const n=document.getElementById("business-search-results");n&&(n.innerHTML="");const o=document.querySelector('#business-search-form input[type="submit"]');o&&(o.disabled=!1,o.style.cursor="pointer"),e&&e.focus()}function l(){if(console.log("Resetting page..."),c(),t){const e=document.getElementById("business-info-section");e&&(e.style.display="none"),function(){a("bname"),a("address1"),a("address2"),a("city"),a("state"),a("zip"),a("phone"),a("type"),a("status");const e=document.querySelector(".alert.alert-info");e&&e.remove(),document.querySelectorAll("input, select, textarea").forEach((e=>{e.disabled=!1,e.classList.remove("disabled-field")}));const t=document.getElementById("update-submit");t&&(t.style.display="block")}()}else if(n){const e=document.getElementById("business-info-section");e&&(e.style.display="none");const t=document.getElementById("incentive-section");t&&(t.style.display="none"),function(){a("bname"),a("address1"),a("address2"),a("city"),a("state"),a("zip"),a("phone"),a("type");const e=document.getElementById("incentiveAvailable"),t=document.getElementById("incentiveNotAvailable");e&&(e.checked=!1),t&&(t.checked=!1),a("incentiveType"),a("incentiveAmount"),a("incentiveInfo");const n=document.getElementById("otherTypeContainer");n&&(n.style.display="none"),a("otherTypeDescription");const o=document.getElementById("discountTypePercentage");o&&(o.checked=!0);const s=document.getElementById("discountTypeDollar");s&&(s.checked=!1),document.querySelectorAll("input, select, textarea").forEach((e=>{e.disabled=!1,e.classList.remove("disabled-field")}))}()}else if(o){const e=document.getElementById("business-info-section");e&&(e.style.display="none");const t=document.getElementById("incentives-list-section");t&&(t.style.display="none");const n=document.getElementById("incentive-edit-section");n&&(n.classList.remove("force-display"),n.setAttribute("style","display: none !important"));const o=document.getElementById("incentives-table-container");o&&(o.innerHTML=""),function(){const e=document.getElementById("incentiveAvailable"),t=document.getElementById("incentiveNotAvailable");e&&(e.checked=!1),t&&(t.checked=!1),a("incentiveType"),a("incentiveAmount"),a("incentiveInfo"),a("otherTypeDescription");const n=document.getElementById("otherTypeContainer");n&&(n.style.display="none");const o=document.getElementById("discountTypePercentage");o&&(o.checked=!0);const s=document.getElementById("discountTypeDollar");s&&(s.checked=!1),["business-name-display","business-address-display","business-city-state-display","business-phone-display","business-type-display"].forEach((e=>{const t=document.getElementById(e);t&&(t.textContent="")})),document.querySelectorAll("input, select, textarea").forEach((e=>{e.disabled=!1,e.classList.remove("disabled-field")})),document.querySelectorAll(".alert.alert-info, .alert.alert-warning").forEach((e=>{e.remove()}))}()}else if(s){const e=document.getElementById("business-info-section");e&&(e.style.display="none");const t=document.getElementById("incentives-container");t&&(t.innerHTML="");const n=document.getElementById("floating-reset-button-container");n&&n.remove()}const e=document.getElementById("selected-business-id");e&&(e.value="");const i=document.getElementById("selected-incentive-id");i&&(i.value="");const d=document.getElementById("status-message");d&&(d.style.display="none",d.innerHTML=""),void 0!==window.selectedBusinessData&&(window.selectedBusinessData=null),window.scrollTo(0,0),console.log("Page has been reset")}function a(e){const t=document.getElementById(e);t&&("SELECT"===t.tagName?t.selectedIndex=0:"TEXTAREA"!==t.tagName&&"INPUT"!==t.tagName||(t.value=""),t.classList.remove("valid-field"),t.classList.remove("invalid-field"),t.classList.remove("disabled-field"),t.disabled=!1)}console.log("Page detection - Business Update:",t,"Add:",n,"Update:",o,"View:",s);const r=document.createElement("style");function u(e){e&&(e.classList.add("hidden-by-reset"),setTimeout((()=>{e.style.display="none",e.setAttribute("style","display: none !important")}),10))}r.textContent='\n        /* Higher specificity to override force-display */\n        body #incentive-edit-section.hidden-by-reset,\n        body #incentives-list-section.hidden-by-reset,\n        body #business-info-section.hidden-by-reset {\n            display: none !important;\n        }\n        \n        /* FIXED: Style to prevent overriding field state */\n        input:not([disabled]),\n        select:not([disabled]),\n        textarea:not([disabled]) {\n            opacity: 1 !important;\n            pointer-events: auto !important;\n        }\n        \n        /* FIXED: Make sure buttons are always clickable */\n        #business-search-form input[type="submit"],\n        #reset-button,\n        .clear-button {\n            cursor: pointer !important;\n            opacity: 1 !important;\n            pointer-events: auto !important;\n        }\n    ',document.head.appendChild(r);const m=l;if(l=function(){m(),o&&(u(document.getElementById("incentive-edit-section")),u(document.getElementById("incentives-list-section")),u(document.getElementById("business-info-section")))},setTimeout((function(){const e=document.querySelector("fieldset:first-of-type");if(e){const t=d(),n=i();n.innerText="Clear Search",n.addEventListener("click",(function(){c()})),t.appendChild(n),e.appendChild(t)}if(t){const e=document.getElementById("business-info-section");if(e&&(new MutationObserver((function(t){t.forEach((function(t){if("style"===t.attributeName&&"none"!==e.style.display&&!e.querySelector("#reset-button-container")){const t=d(),n=i();n.addEventListener("click",(function(){l()})),t.appendChild(n),e.appendChild(t)}}))})).observe(e,{attributes:!0}),"none"!==e.style.display&&!e.querySelector("#reset-button-container"))){const t=d(),n=i();n.addEventListener("click",(function(){l()})),t.appendChild(n),e.appendChild(t)}}else if(n){const e=document.getElementById("incentive-section");if(e&&(new MutationObserver((function(t){t.forEach((function(t){if("style"===t.attributeName&&"none"!==e.style.display&&!e.querySelector("#reset-button-container")){const t=d(),n=i();n.addEventListener("click",(function(){l()})),t.appendChild(n),e.appendChild(t)}}))})).observe(e,{attributes:!0}),"none"!==e.style.display&&!e.querySelector("#reset-button-container"))){const t=d(),n=i();n.addEventListener("click",(function(){l()})),t.appendChild(n),e.appendChild(t)}}else if(o){const e=document.getElementById("incentive-edit-section");if(e&&(new MutationObserver((function(t){t.forEach((function(t){if("style"===t.attributeName&&"none"!==e.style.display&&!e.querySelector("#reset-button-container")){const t=d(),n=i();n.addEventListener("click",(function(){l()})),t.appendChild(n),e.appendChild(t)}}))})).observe(e,{attributes:!0}),"none"!==e.style.display&&!e.querySelector("#reset-button-container"))){const t=d(),n=i();n.addEventListener("click",(function(){l()})),t.appendChild(n),e.appendChild(t)}}else if(s){document.querySelector("main");const e=document.getElementById("incentives-container");if(e){const t=new MutationObserver((function(n){if(""!==e.innerHTML&&!document.getElementById("floating-reset-button-container")){const e=document.createElement("div");e.id="floating-reset-button-container",e.style.position="fixed",e.style.bottom="20px",e.style.right="20px",e.style.zIndex="1000";const n=i();n.style.boxShadow="0 2px 5px rgba(0,0,0,0.3)",n.addEventListener("click",(function(){l()})),e.appendChild(n);const o=document.querySelector("footer");o&&o.parentNode?document.body.insertBefore(e,o):document.body.appendChild(e),t.disconnect()}}));if(t.observe(e,{childList:!0,subtree:!0}),""!==e.innerHTML&&"<p>Loading incentives...</p>"!==e.innerHTML&&!document.getElementById("floating-reset-button-container")){const e=document.createElement("div");e.id="floating-reset-button-container",e.style.position="fixed",e.style.bottom="20px",e.style.right="20px",e.style.zIndex="1000";const t=i();t.style.boxShadow="0 2px 5px rgba(0,0,0,0.3)",t.addEventListener("click",(function(){l()})),e.appendChild(t);const n=document.querySelector("footer");n&&n.parentNode?document.body.insertBefore(e,n):document.body.appendChild(e)}}}}),500),t){const e=document.getElementById("business-update-form");e&&(e.onsubmit,e.addEventListener("submit",(function(e){if(!e.target.hasAttribute("data-reset-handler")){e.target.setAttribute("data-reset-handler","true");const t=document.getElementById("update-submit"),n=t?t.value:"Update Business";t&&(t.value="Updating...",t.disabled=!0),setTimeout((()=>{const e=document.getElementById("status-message");e&&(e.className="alert alert-success",e.innerHTML="Business updated successfully!",e.style.display="block"),t&&(t.value=n,t.disabled=!1),setTimeout((()=>{l()}),2e3)}),1e3)}})))}const y=document.createElement("style");y.textContent="\n        @media (max-width: 768px) {\n            #reset-button {\n                width: 100%;\n                padding: 15px;\n                font-size: 16px;\n                margin-top: 10px;\n            }\n            \n            #reset-button-container {\n                margin: 10px 0;\n            }\n            \n            #reset-button-container button {\n                box-shadow: 0 2px 5px rgba(0,0,0,0.3);\n            }\n            \n             #floating-reset-button-container {\n                width: 80%;\n                left: 10%;\n                right: 10%;\n                bottom: 20px;\n                text-align: center;\n            }\n            \n            #floating-reset-button-container button {\n                width: 100%;\n                padding: 15px;\n                font-size: 16px;\n                box-shadow: 0 4px 8px rgba(0,0,0,0.3);\n            }\n        }\n    ",document.head.appendChild(y),document.addEventListener("keydown",(function(e){e.altKey&&"r"===e.key&&(e.preventDefault(),l())}));const p=window.alert;window.alert=function(e){p(e),e&&"string"==typeof e&&(e.toLowerCase().includes("success")||e.toLowerCase().includes("added")||e.toLowerCase().includes("updated"))&&(console.log("Success message detected, scheduling auto-reset"),setTimeout((()=>{l()}),1500))},console.log("Enhanced reset functionality setup complete")}));