document.addEventListener("DOMContentLoaded",(function(){console.log("Direct Incentive Fixes Loaded!");const e=function(){document.querySelectorAll(".select-incentive").forEach((e=>{const i=e.cloneNode(!0);e.parentNode.replaceChild(i,e),i.addEventListener("click",(function(e){e.preventDefault();const i=this.getAttribute("data-incentive-id");console.log("Direct fix handling incentive:",i);const c=this.closest("tr"),o="Yes"===c.cells[0].textContent,l=c.cells[1].textContent,s=(d=(d=l).trim()).startsWith("Veteran")?"VT":d.startsWith("Active-Duty")?"AD":d.startsWith("First Responder")?"FR":d.startsWith("Spouse")?"SP":d.startsWith("Other")?"OT":d;var d;const a="OT"===s?function(e){const t=e.match(/\((.*?)\)/);return t?t[1]:""}(l):"";console.log("From table - Available:",o,"Type:",s,"Other:",a),function(e,i,c,o){console.log("Direct setting - ID:",e,"Available:",i,"Type:",c,"Other:",o);const l=document.getElementById("selected-incentive-id");l&&(l.value=e);const s=document.getElementById("incentiveAvailable"),d=document.getElementById("incentiveNotAvailable");s&&d&&(i?(s.checked=!0,d.checked=!1):(s.checked=!1,d.checked=!0),t());const a=document.getElementById("incentiveType");if(a){for(let e=0;e<a.options.length;e++)if(a.options[e].value===c){a.selectedIndex=e;break}n("OT"===c)}if("OT"===c){const e=document.getElementById("otherTypeDescription");e&&(e.value=o)}}(i,o,s,a),function(){const e=document.getElementById("incentive-edit-section");e&&(e.style.display="block",e.setAttribute("style","display: block !important"),e.classList.add("force-display"),setTimeout((()=>{e.scrollIntoView({behavior:"smooth"})}),100))}()}))}))};function t(){const e=document.getElementById("incentiveAvailable"),t=e&&e.checked;["incentiveType","incentiveAmount","incentiveInfo","discountTypePercentage","discountTypeDollar"].forEach((e=>{const n=document.getElementById(e);n&&(n.disabled=!t,t?n.classList.remove("disabled-field"):n.classList.add("disabled-field"))}));const i=document.getElementById("incentiveType")?.value;n(t&&"OT"===i)}function n(e){const t=document.getElementById("otherTypeContainer"),n=document.getElementById("otherTypeDescription");t&&(t.style.display=e?"block":"none"),n&&(n.disabled=!e,e?n.classList.remove("disabled-field"):n.classList.add("disabled-field"))}const i=document.getElementById("incentiveAvailable"),c=document.getElementById("incentiveNotAvailable");i&&i.addEventListener("change",t),c&&c.addEventListener("change",t);const o=document.getElementById("incentiveType");o&&o.addEventListener("change",(function(){const e=document.getElementById("incentiveAvailable")?.checked;n(e&&"OT"===this.value)}));const l=new MutationObserver((function(t){t.forEach((function(t){"childList"===t.type&&t.addedNodes.length>0&&document.querySelectorAll(".select-incentive").length>0&&(console.log("Found incentive buttons, enhancing with direct fix"),e())}))})),s=document.getElementById("incentives-table-container");s&&l.observe(s,{childList:!0,subtree:!0}),e(),console.log("Direct incentive fixes initialized")}));