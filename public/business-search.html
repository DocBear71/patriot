<!DOCTYPE html>
<html lang='en'>
<!-- Update the head section of your HTML file -->
<head>
    <title>Patriot Thanks: Search for a Business</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="author" content="Edward G. McKeown">
    <meta name="date" content="2025/4/12">
    <meta name="description" content="Patriot Thanks application to find businesses that offer
                                          incentives and discounts to veterans, active duty, first
                                          responders, and their spouses.">
    <meta name="keywords" content="business, incentives, discounts, veteran discounts, military discounts,
                                       first responder discounts, veterans, active duty, first responders">
    <link href="./images/docbearlogov4.png" rel="icon" type="image/x-icon">
    <link rel="stylesheet" type="text/css" href="./css/bootstrap-4.0.0.css" >
    <link href="./css/normalize.css" rel="stylesheet">
    <link href="./css/style.css" rel="stylesheet">
    <link href="./css/forms.css" rel="stylesheet">
    <link href="./css/menu-auth.css" rel="stylesheet">
    <link href="./css/form-validation.css" rel="stylesheet">
    <link href="./css/table.css" rel="stylesheet">
    <link href="./css/map.css" rel="stylesheet">
    <script src="./js/jquery-3.7.1.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js"></script>
    <script src="./js/bootstrap-4.0.0.js"></script>
    <script src="./js/reset-functionality.js"></script>

    <!-- Runtime Google Maps API key config -->
    <script src="./js/runtime-config.js"></script>

    <!-- Dynamic Google Maps script insertion -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Get API key from runtime config or fallback to a placeholder
            // The placeholder will be replaced during build if environment variable is available
            const apiKey = window.appConfig?.googleMapsApiKey || 'AIzaSyCHKhYZwQR37M_0QctXUQe6VFRFrlhaYj8';

            // Create and insert the Google Maps script with marker library included
            const script = document.createElement('script');
            script.src = `https://maps.googleapis.com/maps/api/js?key=${apiKey}&libraries=places,geometry,marker&callback=initGoogleMap`;
            script.async = true;
            script.defer = true;
            script.onerror = function() {
                console.error('Google Maps API failed to load. Check your API key.');
                alert('Error loading Google Maps. Please try again later.');
            };
            document.head.appendChild(script);
        });
    </script>

    <!-- Your business search script -->
    <script src="./js/business-search.js"></script>
</head>

<body style="padding-top: 70px" id="page_layout">
<!--Navigation bar-->
<div id="nav-placeholder">
</div>
<script>
    $(function(){
        $("#nav-placeholder").load("NavBar.html", function() {
            console.log("NavBar loaded");
            // Load the login handler after the navbar is loaded
            $.getScript("./js/login-handler.js")
            .done(function() {
                console.log("Login handler script loaded successfully");
            })
            .fail(function() {
                console.error("Failed to load login-handler.js");
            });
        });
    });
</script>
<!--end of Navigation bar-->
<header>
<br>
    <div class="left-banner">
        <a href="index.html">
            <img src="./images/docbearlogov4.png" alt="DocBear logo">
        </a>
    </div>
    <div class="right-banner">
        <br>
        <h1>Patriot Thanks</h1>
        <hr>
        <h4>Search for a Business</h4>
    </div>
    <div style="clear:left;"></div>
</header>
<main>
    <section class="container">
        <h2>Search for a business within our database</h2>
        <p class="paragraph_style">In Patriot Thanks, you can search for a businesses within your local
            area that offers discounts and/or incentives for "active duty, veterans, first responders, and their
            spouses." If you know of a business that offers discounts and/or incentives, Please add them in the add a business section. </p>
    </section>
    <div class="left_pane">
        <fieldset>
            <legend>
                <h3 class="caveat">Search for a Business</h3>
            </legend>
            <form id="business-search-form" onsubmit="return false">
                <br>
                <label for="business-name">Business Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label>
                <input type="text" id="business-name" name="business_name" placeholder="Business Name...">
                <br>
                <label for="address">Address Search&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label>
                <input type="text" id="address" name="street-address" placeholder="Address, City, State, or Zip" >
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <input type="submit" value="Search Business">
            </form>
        </fieldset>
        <br><br><br>

    </div>
    <div class="right_pane">
    <img src="images/home_free.webp" alt="Home of the free patriotic picture" id="home_free">

    </div>
    <div style="clear:both"></div>
    <div class="spacer"></div>

    <!-- Google Maps Container -->
    <div id="map-container">
        <div class="map-controls">
            <div>
                <h3 class="caveat">Business Map</h3>
            </div>
            <div>
                <button id="reset-map" class="btn btn-sm btn-secondary">Reset Map View</button>
            </div>
        </div>
        <div id="map"></div>
        <div class="map-legend">
            <div class="legend-item">
                <div class="legend-color primary"></div>
                <span>Search Results</span>
            </div>
            <div class="legend-item">
                <div class="legend-color nearby"></div>
                <span>Nearby Similar Businesses</span>
            </div>
        </div>
    </div>
    <!-- Business Search Results Table -->
    <div id="business-search-results"></div>

    <section id="search_table" style="display: none;">
        <h5 style="display: none;">hidden</h5>
        <figure id="business_search" class="middle">
            <figcaption class="caveat">Businesses Found</figcaption>
            <table>
                <thead>
                <tr>
                    <th>Business Name</th>
                    <th>Location</th>
                    <th>Description</th>
                    <th>Offers/Incentives</th>
                    <th>Map</th>
                </tr>
                </thead>
                <tbody>
                <!-- Search results will be inserted here -->
                </tbody>
                <tfoot>
                <tr>
                    <th>Business Name</th>
                    <th>Location</th>
                    <th>Description</th>
                    <th>Offers/Incentives</th>
                    <th>Map</th>
                </tr>
                </tfoot>
            </table>
        </figure>
    </section>

</main>
<footer class = "footer_style"><br>
    <p>&copy; Copyright 2024 Edward G. McKeown</p>
    <address>
        <p>email to <a href='emailto:edward-mckeown@student.kirkwood.edu'>
            edward-mckeown@student.kirkwood.edu</a></p><br>
    </address>
</footer>
</body>
</html>